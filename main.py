from cms_detection import detect_cms
from vulnerability_scanner import scan_vulnerabilities
from exploit_generator import generate_exploit

def main():
    url = input("Digite a URL do site de destino: ")
    cms = detect_cms(url)
    
    if cms != 'Unknown':
        print(f"CMS Detectado: {cms}")
        vulnerabilities = scan_vulnerabilities(cms, url)
        
        if vulnerabilities:
            print("Vulnerabilidades encontradas:")
            for vuln in vulnerabilities:
                print(f"- {vuln}")
            exploit_link = generate_exploit(vulnerabilities)
            print(f"Link do exploit: {exploit_link}")
        else:
            print("Nenhuma vulnerabilidade encontrada.")
    else:
        print("CMS n√£o detectado ou desconhecido.")
        
if __name__ == "__main__":
    main()